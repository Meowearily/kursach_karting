from sqlmodel import Field, Relationship, SQLModel

from datetime import date, time

class RaceRacerKart(SQLModel, table=True):
    race_id: int = Field(foreign_key="race_racer_kart.race_id")
    racer_id: int = Field(foreign_key="race_racer_kart.racer_id")
    kart_id: int = Field(foreign_key="race_racer_kart.kart_id")
    duration: time

    race: "Race" = Relationship(back_populates="participants")
    racer: "Racer" = Relationship(back_populates="race_entries")

class WorkersRace(SQLModel, table=True):
    worker_id: int = Field(foreign_key="workers.id")
    race_id: int = Field(foreign_key="races.id")

    workers: "Workers" = Relationship(back_populates="races")
    races: "Races" = Relationship(back_populates="staff")

class Tracks(SQLModel, table=True):
    id: int = Field(default=None, primary_key=True)
    name: str
    state: bool
    open: bool
    length: float

    races: list["Races"] = Relationship(back_populates="track")

class Racers(SQLModel, table=True):
    id: int = Field(default=None, primary_key=True)
    name: str
    club_card: bool
    date_of_birth: date
    date_of_registration: date
    best_time: time

    race_entries: List[RaceRacerKart] = Relationship(back_populates="racer")

class Karts(SQLModel, table=True):
    id: int = Field(default=None, primary_key=True)
    model: str
    state: bool
    tires: str
    tires_change_date: date
    rain: bool

class Workers(SQLModel, table=True):
    id: int = Field(default=None, primary_key=True)
    name: str
    date_of_birth: date
    status: str
    salary: float

class Races(SQLModel, table=True):
    id: int = Field(default=None, primary_key=True)
    track_id: int = Field(foreign_key="races.id")

    tracks: Tracks = Relationship(back_populates="races")